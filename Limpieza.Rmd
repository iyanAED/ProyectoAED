---
title: "Limpieza_Datos"
author: "Iyán Álvarez, Azahara Martínez, Juan Alcaraz Otón"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(dplyr)
library(stringr)
library(lubridate)
library(tidyr)
library(tidyverse)
```


## IMPORTACIÓN

```{r Importación del dataframe}
url_ocupacion <- "https://www.ine.es/jaxiT3/files/t/es/csv_bdsc/65311.csv?nocab=1"
url_hoteles <- "https://www.ine.es/jaxiT3/files/t/es/csv_bdsc/67190.csv?nocab=1"

df_Hoteles <- read.csv(url_hoteles,
                       header = TRUE,
                       sep = ";",
                       dec = ".")

df_Ocupacion <- read.csv(url_ocupacion,
                       header = TRUE,
                       sep = ";",
                       dec = ".")
```

## LIMPIEZA BASE DE DATOS 

###TURISMO 

Elinamos las filas que corresponden al total nacional y a las Comunidades Autónomas ya que son redundantes y se pueden sacar a partir del resto de datos si se necesitaran.

```{r}
df_Hoteles <- df_Hoteles %>%
  select(-Totales.Territoriales)%>%
  filter(str_trim(Comunidades.y.Ciudades.Autónomas) != "", str_trim(Provincias) != "")
```

Ahora voy a toquetear las fechas

```{r}
df_Hoteles <- df_Hoteles%>%
  separate(col=Periodo,into=c('Año', 'Mes'), sep='M')

df_Hoteles <- df_Hoteles %>%
  mutate(fecha = ym(paste0(Año, "-", Mes)))
```

